<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TaskMaster</title>
  <link rel="stylesheet" href="assets/CSS/global.css">
  <link rel="stylesheet" href="templates/background/background.css">
  <link rel="stylesheet" href="components/sidebar.html" />
<link rel="stylesheet" href="templates/dashboard/dashboard.css" />
</head>

<body>
  
  <div class="app-shell">
    <div id="templates-root"></div>
  </div>
  
  <script src="assets/js/global.js"></script>
 
  <script>
    (function loadTemplates() {
      const root = document.getElementById('templates-root');
      const templates = [
        { path: 'templates/loginpage/login.html', id: 'login-template' },
        { path: 'templates/signuppage/signup.html', id: 'signup-template' },
        { path: 'templates/dashboard/dashboard.html', id: 'dashboard-template' }
      ];

      function fetchText(path){
        return fetch(path).then(res => {
          if (!res.ok) throw new Error('Failed to load ' + path);
          return res.text();
        });
      }

      Promise.all(templates.map(t => fetchText(t.path).then(html => ({ id: t.id, html })) ))
        .then(results => {
          results.forEach(r => {
            const wrapper = document.createElement('div');
            wrapper.id = r.id;
            wrapper.className = 'template';
            wrapper.style.display = 'none';
            wrapper.innerHTML = r.html;
            root.appendChild(wrapper);
          });

          // After templates injected, initialize default view
          if (window.App && typeof App.show === 'function') {
            const logged = App.getLoggedIn();
            if (logged) App.show('dashboard-template');
            else App.show('login-template');
          } else {
            const first = document.getElementById('login-template');
            if (first) first.style.display = 'block';
          }
        })
        .catch(err => {
          root.innerHTML = '';
          console.error(err);
        });
    })();
  </script>
</body>
</html>